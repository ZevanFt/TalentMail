# TalentMail 待办事项清单

本文档记录了项目当前待完善的功能和未来的开发计划。

> 最后更新：2025-02-03

## 功能完成度概览

| 模块 | 完成度 | 状态 | 说明 |
|------|--------|------|------|
| 核心邮件功能 | 100% | 已完成 | SMTP/IMAP、附件、全文搜索等 |
| 用户系统 | 100% | 已完成 | 登录、注册、2FA、会话管理 |
| 工作流系统 | 100% | 已完成 | 图遍历引擎、条件分支、并行执行、事件驱动 |
| 模板系统 | 100% | 已完成 | 可视化编辑、变量替换、测试发送 |
| 自动化规则 | 100% | 已完成 | 规则引擎、条件匹配、动作执行 |
| 账号池功能 | 100% | 已完成 | 临时邮箱、验证码识别 |
| 订阅计费 | 100% | 已完成 | 套餐管理、兑换码 |
| PWA 支持 | 100% | 已完成 | 可安装为桌面/移动应用 |
| 安全性功能 | 100% | 已完成 | 密码加密、配置加密、会话识别 |
| 批量操作 | 100% | 已完成 | 批量读/星标/移动/删除/归档 |
| 垃圾邮件 | 100% | 已完成 | 白名单、标记、SpamAssassin |

## 已完成的高优先级任务

### 1. 安全性增强
- [x] **密码加密存储** - 2025-02-01
  - 创建 `core/crypto.py` 加密模块
  - Fernet 对称加密算法
  - 数据迁移脚本

- [x] **会话识别优化** - 2025-02-03
  - JWT token 中添加 session_id
  - TokenData schema 添加 session_id 字段
  - 会话列表 API 支持 is_current 标识

- [x] **敏感配置加密** - 2025-02-03
  - `scripts/config_encrypt.py` 配置加密工具
  - 支持 encrypt/decrypt 单个值
  - 支持 encrypt-file/decrypt-file 整个 .env 文件

### 2. 工作流引擎升级
- [x] **支持复杂流程图** - 2025-02-03
  - GraphExecutor 图遍历执行器
  - 条件分支（通过 source_handle）
  - 并行执行（asyncio.gather）
  - 完全向后兼容

- [x] **高级节点类型** - 2025-02-03
  - DelayHandler - 延时等待节点
  - LoopHandler - 循环执行节点
  - ParallelHandler - 并行执行节点
  - SwitchHandler - 多路分支节点
  - WebhookHandler - Webhook 调用节点
  - TransformHandler - 数据转换节点

- [x] **工作流底层逻辑完善** - 2025-02-03
  - 41 个节点处理器
  - 34 个节点类型，32 个有 config_schema
  - 4 个系统工作流绑定事件
  - 业务代码触发点：user.registered, user.login, password.changed

### 3. 邮件系统功能
- [x] **全文搜索引擎** - 2025-02-03
  - PostgreSQL 原生全文搜索（tsvector + GIN 索引）
  - 自动更新触发器
  - 按相关性排序（ts_rank）

- [x] **垃圾邮件过滤** - 2025-02-03
  - 白名单管理 API
  - 标记垃圾/非垃圾邮件
  - SpamAssassin 学习接口

- [x] **批量操作功能** - 2025-02-03
  - 批量标记已读/未读
  - 批量标记星标
  - 批量移动/删除/归档

## 中优先级任务（待开发）

### 1. 前端功能
- [ ] **批量操作前端组件**
  - 邮件列表多选组件
  - 批量操作工具栏
  - 操作进度提示

- [ ] **工作流可视化编辑器**
  - 拖拽式节点编辑
  - 实时预览
  - 节点配置表单

- [ ] **键盘快捷键系统**
  - 全局快捷键定义
  - 自定义快捷键
  - 快捷键提示面板

### 2. 系统功能
- [ ] **备份恢复机制**
  - 自动备份策略
  - 手动备份/恢复
  - 备份加密

- [ ] **操作日志审计**
  - 完整的操作记录
  - 日志查询界面
  - 异常行为检测

- [ ] **性能监控系统**
  - 系统资源监控
  - 邮件队列监控
  - 告警通知

## 低优先级任务

### 1. 用户体验
- [ ] **主题系统扩展**
  - 更多预设主题
  - 自定义主题编辑器

- [ ] **国际化完善**
  - 更多语言支持
  - 语言包管理

### 2. 集成功能
- [ ] **第三方日历集成**
  - Google Calendar
  - Outlook Calendar

- [ ] **API 开放平台**
  - API Key 管理
  - 开发者文档
  - 速率限制

---

**相关文档**：
- [当前开发任务](./current-tasks.md)
- [开发指南](../04-development/README.md)
