<p align="center">
  <img src="logo.png" alt="Talenting Logo" width="400">
</p>

<h1 align="center">TalentMail</h1>

<p align="center">
  <strong>ğŸš€ ç°ä»£åŒ–è‡ªæ‰˜ç®¡é‚®ä»¶æœåŠ¡å¹³å°</strong>
</p>

<p align="center">
  ä¸€ä¸ªåŠŸèƒ½å®Œæ•´ã€å®‰å…¨å¯é çš„ä¼ä¸šçº§é‚®ä»¶è§£å†³æ–¹æ¡ˆ
</p>

---

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### ğŸ“§ æ ¸å¿ƒé‚®ä»¶åŠŸèƒ½
- **é‚®ä»¶æ”¶å‘** - å®Œæ•´çš„ SMTP/IMAP æ”¯æŒï¼Œæ”¯æŒé™„ä»¶ã€HTML é‚®ä»¶
- **æ–‡ä»¶å¤¹ç®¡ç†** - æ”¶ä»¶ç®±ã€å·²å‘é€ã€è‰ç¨¿ã€åƒåœ¾ç®±ã€å½’æ¡£ç­‰
- **é‚®ä»¶æœç´¢** - å¿«é€Ÿå…¨æ–‡æœç´¢ï¼Œæ”¯æŒå¤šæ¡ä»¶ç­›é€‰
- **é‚®ä»¶è¿½è¸ª** - æ‰“å¼€è¿½è¸ªã€æŠ•é€’çŠ¶æ€å®æ—¶åé¦ˆ
- **è‰ç¨¿ä¸å®šæ—¶å‘é€** - ä¿å­˜è‰ç¨¿ï¼Œå®šæ—¶å‘é€é‚®ä»¶
- **å›å¤ä¸è½¬å‘** - æ”¯æŒå¼•ç”¨å›å¤ã€è½¬å‘é‚®ä»¶

### ğŸ” å®‰å…¨ä¸éšç§
- **JWT è®¤è¯** - å®‰å…¨çš„ç”¨æˆ·è®¤è¯æœºåˆ¶
- **ä¸¤æ­¥éªŒè¯ (2FA)** - TOTP éªŒè¯å™¨æ”¯æŒ
- **ç™»å½•è®¾å¤‡ç®¡ç†** - æŸ¥çœ‹å’Œç®¡ç†ç™»å½•è®¾å¤‡
- **éšç§è®¾ç½®** - é˜»æ­¢å¤–éƒ¨å›¾ç‰‡ã€åƒåœ¾é‚®ä»¶è¿‡æ»¤

### ğŸ‘¥ ç”¨æˆ·ç®¡ç†
- **é‚€è¯·ç æ³¨å†Œ** - å¯æ§çš„ç”¨æˆ·å¢é•¿
- **é‚®ç®±éªŒè¯ç ** - å®‰å…¨çš„æ³¨å†Œæµç¨‹
- **ä¼šå‘˜è®¢é˜…åˆ¶åº¦** - çµæ´»çš„å¥—é¤ç®¡ç†
- **ç”¨æˆ·æƒé™ç®¡ç†** - ç®¡ç†å‘˜/æ™®é€šç”¨æˆ·è§’è‰²

### ğŸ“® è´¦å·æ± åŠŸèƒ½
- **ä¸´æ—¶é‚®ç®±** - å¿«é€Ÿåˆ›å»ºä¸´æ—¶é‚®ç®±
- **éªŒè¯ç è¯†åˆ«** - è‡ªåŠ¨æå–é‚®ä»¶ä¸­çš„éªŒè¯ç 
- **ç»Ÿè®¡åˆ†æ** - é‚®ç®±ä½¿ç”¨æƒ…å†µç»Ÿè®¡

### ğŸ¨ ç”¨æˆ·ä½“éªŒ
- **æ·±è‰²/æµ…è‰²ä¸»é¢˜** - è‡ªé€‚åº”ç³»ç»Ÿä¸»é¢˜
- **å®æ—¶é€šçŸ¥** - WebSocket å®æ—¶æ¨é€
- **å“åº”å¼è®¾è®¡** - é€‚é…å„ç§å±å¹•å°ºå¯¸
- **é‚®ä»¶ç­¾å** - è‡ªå®šä¹‰é‚®ä»¶ç­¾å

---

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

| å±‚çº§ | æŠ€æœ¯ |
|------|------|
| **å‰ç«¯** | Nuxt.js 3, Vue.js 3, TypeScript, Tailwind CSS |
| **åç«¯** | FastAPI, Python 3, Pydantic V2, SQLAlchemy |
| **æ•°æ®åº“** | PostgreSQL |
| **é‚®ä»¶æœåŠ¡** | docker-mailserver (Postfix + Dovecot) |
| **åå‘ä»£ç†** | Caddy |
| **å®¹å™¨åŒ–** | Docker, Docker Compose |

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- Docker & Docker Compose
- Git

### å¼€å‘ç¯å¢ƒéƒ¨ç½²

#### ç¬¬ 1 æ­¥ï¼šé…ç½®æœ¬åœ° DNS

ç¼–è¾‘ `/etc/hosts` (Linux/macOS) æˆ– `C:\Windows\System32\drivers\etc\hosts` (Windows)ï¼š

```
127.0.0.1   mail.talenting.test
```

#### ç¬¬ 2 æ­¥ï¼šå¯åŠ¨å¼€å‘ç¯å¢ƒ

```bash
# å…‹éš†é¡¹ç›®
git clone <repository-url>
cd talentmail

# ä½¿ç”¨å¼€å‘è„šæœ¬å¯åŠ¨ (æ¨è)
chmod +x dev.sh
./dev.sh

# æˆ–æ‰‹åŠ¨å¯åŠ¨
docker compose -f docker-compose.dev.yml up -d --build
```

#### ç¬¬ 3 æ­¥ï¼šåˆå§‹åŒ–æ•°æ®åº“ï¼ˆä»…é¦–æ¬¡ï¼‰

```bash
docker compose -f docker-compose.dev.yml exec backend python -m initial.initial_data
```

#### ç¬¬ 4 æ­¥ï¼šè®¿é—®åº”ç”¨

| æœåŠ¡ | åœ°å€ |
|------|------|
| ä¸»åº”ç”¨ | https://mail.talenting.test |
| å‰ç«¯ (å¤‡ç”¨) | http://localhost:3000 |
| åç«¯ API | http://localhost:8000 |
| API æ–‡æ¡£ | http://localhost:8000/docs |

**é»˜è®¤ç®¡ç†å‘˜è´¦æˆ·**: `admin@talenting.test` / `adminpassword`

---

## âš™ï¸ é…ç½®è¯´æ˜

### æ ¸å¿ƒé…ç½®æ–‡ä»¶

é¡¹ç›®ä½¿ç”¨ `config.json` ä½œä¸ºæ ¸å¿ƒé…ç½®æ–‡ä»¶ï¼ˆå•ä¸€äº‹å®æ¥æºï¼‰ï¼š

```json
{
  "currentEnvironment": "development",
  "environments": {
    "development": {
      "baseDomain": "talenting.test",
      "webPrefix": "mail",
      "mailServerPrefix": "maillink"
    },
    "production": {
      "baseDomain": "talenting.vip",
      "webPrefix": "mail",
      "mailServerPrefix": "maillink"
    }
  }
}
```

### ç¯å¢ƒå˜é‡é…ç½® (.env)

å¤åˆ¶ç¤ºä¾‹æ–‡ä»¶å¹¶ç¼–è¾‘ï¼š

```bash
cp .env.example .env
nano .env
```

**å¿…å¡«é…ç½®é¡¹ï¼š**

| å˜é‡ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| `CURRENT_ENVIRONMENT` | å½“å‰ç¯å¢ƒ | `development` æˆ– `production` |
| `SECRET_KEY` | JWT å¯†é’¥ | `openssl rand -hex 32` ç”Ÿæˆ |
| `POSTGRES_PASSWORD` | æ•°æ®åº“å¯†ç  | è®¾ç½®å¼ºå¯†ç  |
| `ADMIN_PASSWORD` | ç®¡ç†å‘˜å¯†ç  | è®¾ç½®å¼ºå¯†ç  |
| `DEFAULT_MAIL_PASSWORD` | é‚®ä»¶è´¦æˆ·é»˜è®¤å¯†ç  | è®¾ç½®å¼ºå¯†ç  |

---

## ğŸŒ ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

### 1. æœåŠ¡å™¨è¦æ±‚

- **æ“ä½œç³»ç»Ÿ**: Ubuntu 20.04 LTS æˆ– 22.04 LTS
- **é…ç½®**: è‡³å°‘ 2æ ¸ CPU, 4GB å†…å­˜
- **ç«¯å£å¼€æ”¾**: 80, 443, 25, 143, 587, 993

### 2. DNS é…ç½® (Cloudflare)

| ç±»å‹ | åç§° | å†…å®¹ | ä»£ç†çŠ¶æ€ | è¯´æ˜ |
|------|------|------|----------|------|
| **A** | `mail` | `æœåŠ¡å™¨IP` | âœ… å·²ä»£ç† | Web åº”ç”¨ |
| **A** | `maillink` | `æœåŠ¡å™¨IP` | âŒ ä»… DNS | **å¿…é¡»å…³é—­ä»£ç†ï¼** |
| **MX** | `@` | `maillink.example.com` | - | ä¼˜å…ˆçº§ 10 |
| **TXT** | `@` | `v=spf1 mx ~all` | - | SPF è®°å½• |

> âš ï¸ **é‡è¦**: `maillink` å­åŸŸåå¿…é¡»æ˜¯ **ç°è‰²äº‘æœµ (DNS Only)**ï¼Œå¦åˆ™é‚®ä»¶æ— æ³•æ­£å¸¸æ”¶å‘ï¼

### 3. ä¸€é”®éƒ¨ç½²

```bash
# é…ç½®ç¯å¢ƒå˜é‡
cp .env.example .env
nano .env  # ç¼–è¾‘å¿…å¡«é¡¹

# è¿è¡Œéƒ¨ç½²è„šæœ¬
chmod +x deploy.sh
./deploy.sh
```

### 4. SSL è¯ä¹¦é…ç½® (å¯é€‰)

```bash
# åŒæ­¥ Let's Encrypt è¯ä¹¦åˆ°é‚®ä»¶æœåŠ¡å™¨
chmod +x scripts/sync_mail_certs.sh
./scripts/sync_mail_certs.sh
```

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
talentmail/
â”œâ”€â”€ backend/              # FastAPI åç«¯
â”‚   â”œâ”€â”€ api/              # API è·¯ç”±
â”‚   â”œâ”€â”€ core/             # æ ¸å¿ƒåŠŸèƒ½ (é…ç½®ã€å®‰å…¨ã€é‚®ä»¶)
â”‚   â”œâ”€â”€ crud/             # æ•°æ®åº“æ“ä½œ
â”‚   â”œâ”€â”€ db/               # æ•°æ®åº“æ¨¡å‹
â”‚   â”œâ”€â”€ schemas/          # Pydantic æ¨¡å‹
â”‚   â””â”€â”€ initial/          # åˆå§‹åŒ–æ•°æ®
â”œâ”€â”€ frontend/             # Nuxt.js å‰ç«¯
â”‚   â””â”€â”€ app/
â”‚       â”œâ”€â”€ components/   # Vue ç»„ä»¶
â”‚       â”œâ”€â”€ pages/        # é¡µé¢
â”‚       â”œâ”€â”€ layouts/      # å¸ƒå±€
â”‚       â””â”€â”€ composables/  # ç»„åˆå¼å‡½æ•°
â”œâ”€â”€ config/               # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ caddy/            # Caddy åå‘ä»£ç†é…ç½®
â”‚   â””â”€â”€ mail/             # é‚®ä»¶æœåŠ¡å™¨é…ç½®
â”œâ”€â”€ scripts/              # è¾…åŠ©è„šæœ¬
â”œâ”€â”€ config.json           # æ ¸å¿ƒé…ç½®æ–‡ä»¶
â”œâ”€â”€ dev.sh                # å¼€å‘ç¯å¢ƒè„šæœ¬
â””â”€â”€ deploy.sh             # ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²è„šæœ¬
```

---

## ğŸ”§ å¸¸ç”¨å‘½ä»¤

### å¼€å‘ç¯å¢ƒ

```bash
# å¯åŠ¨å¼€å‘ç¯å¢ƒ (æ¨è)
./dev.sh

# æ‰‹åŠ¨å¯åŠ¨
docker compose -f docker-compose.dev.yml up -d --build

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker compose -f docker-compose.dev.yml ps

# æŸ¥çœ‹æ—¥å¿—
docker compose -f docker-compose.dev.yml logs -f           # æ‰€æœ‰æœåŠ¡
docker compose -f docker-compose.dev.yml logs -f backend   # åç«¯æ—¥å¿—
docker compose -f docker-compose.dev.yml logs -f frontend  # å‰ç«¯æ—¥å¿—
docker compose -f docker-compose.dev.yml logs -f db        # æ•°æ®åº“æ—¥å¿—

# é‡å¯å•ä¸ªæœåŠ¡
docker compose -f docker-compose.dev.yml restart backend
docker compose -f docker-compose.dev.yml restart frontend

# åœæ­¢æœåŠ¡
docker compose -f docker-compose.dev.yml down

# åœæ­¢å¹¶åˆ é™¤æ•°æ®å· (æ¸…ç©ºæ•°æ®åº“)
docker compose -f docker-compose.dev.yml down -v
```

### ç”Ÿäº§ç¯å¢ƒ

```bash
# éƒ¨ç½²/æ›´æ–°
./deploy.sh

# æŸ¥çœ‹æ—¥å¿—
docker compose logs -f                      # æ‰€æœ‰æ—¥å¿—
docker compose logs -f mailserver           # é‚®ä»¶æœåŠ¡æ—¥å¿—

# é‡å¯æœåŠ¡
docker compose restart backend
```

### æ•°æ®åº“ç®¡ç†

```bash
# è¿è¡Œæ•°æ®åº“è¿ç§»
docker compose -f docker-compose.dev.yml exec backend alembic upgrade head

# åˆå§‹åŒ–æ•°æ® (é¦–æ¬¡éƒ¨ç½²åæ‰§è¡Œ)
docker compose -f docker-compose.dev.yml exec backend python -m initial.initial_data

# åˆå§‹åŒ–æ¨¡æ¿æ•°æ®
docker compose -f docker-compose.dev.yml exec backend python -c "from db.database import SessionLocal; from initial.init_template_data import init_template_data; db = SessionLocal(); init_template_data(db); db.close()"
```

### æ¸…ç†ç©ºé—´

```bash
# æ¸…ç† Docker ç¼“å­˜ (é‡Šæ”¾ç£ç›˜ç©ºé—´)
docker system prune -af --volumes
docker builder prune -af
```

---

## ğŸš¨ æ•…éšœæ’é™¤

### æ•°æ®åº“è¿æ¥å¤±è´¥ / ç™»å½•å¤±è´¥

1. **æ£€æŸ¥æœåŠ¡çŠ¶æ€**
   ```bash
   docker compose -f docker-compose.dev.yml ps
   ```
   ç¡®ä¿ db æœåŠ¡æ˜¾ç¤º `healthy`ã€‚

2. **å¦‚æœæ•°æ®åº“æ˜¾ç¤º `unhealthy`**ï¼Œå¯èƒ½æ˜¯ç£ç›˜ç©ºé—´ä¸è¶³ï¼š
   ```bash
   # æ£€æŸ¥ç£ç›˜ç©ºé—´
   df -h /
   
   # æ¸…ç† Docker ç¼“å­˜
   docker system prune -af --volumes
   docker builder prune -af
   
   # é‡å¯æ•°æ®åº“
   docker compose -f docker-compose.dev.yml restart db
   
   # ç­‰å¾…å‡ ç§’åé‡å¯åç«¯
   sleep 5 && docker compose -f docker-compose.dev.yml restart backend
   ```

3. **æŸ¥çœ‹æ•°æ®åº“æ—¥å¿—**
   ```bash
   docker compose -f docker-compose.dev.yml logs db --tail 50
   ```

### é‚®ä»¶æ¨¡æ¿åŠ è½½å¤±è´¥

å¦‚æœç®¡ç†å‘˜é¡µé¢æ˜¾ç¤º"åŠ è½½å¤±è´¥"ï¼Œè¿è¡Œæ¨¡æ¿åˆå§‹åŒ–ï¼š
```bash
docker compose -f docker-compose.dev.yml exec backend python -c "
from db.database import SessionLocal
from initial.init_template_data import init_template_data
db = SessionLocal()
init_template_data(db)
db.close()
print('æ¨¡æ¿æ•°æ®åˆå§‹åŒ–å®Œæˆ')
"
```

### å‰ç«¯é¡µé¢æ— æ³•è®¿é—®

```bash
# æ£€æŸ¥å‰ç«¯æœåŠ¡
docker compose -f docker-compose.dev.yml logs frontend --tail 20

# é‡æ–°æ„å»ºå‰ç«¯
docker compose -f docker-compose.dev.yml up -d --build frontend
```

---

## ğŸ“Š åŠŸèƒ½å®Œæˆåº¦

| æ¨¡å— | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|
| æ ¸å¿ƒé‚®ä»¶åŠŸèƒ½ | âœ… 100% | SMTP/IMAP æ”¶å‘ã€é™„ä»¶ã€æœç´¢ |
| é«˜çº§é‚®ä»¶åŠŸèƒ½ | âœ… 100% | é‚®ä»¶è¿½è¸ªã€è‰ç¨¿ã€å›å¤è½¬å‘ |
| é™„ä»¶åŠŸèƒ½ | âœ… 100% | ä¸Šä¼ ã€ä¸‹è½½ã€é¢„è§ˆ |
| ä¼šå‘˜è®¢é˜… | âœ… 100% | å¥—é¤ç®¡ç†ã€å…‘æ¢ç  |
| ç”¨æˆ·ç³»ç»Ÿ | âœ… 90% | ç™»å½•ã€æ³¨å†Œã€2FAã€è®¾å¤‡ç®¡ç† |
| è´¦å·æ±  | âœ… 100% | ä¸´æ—¶é‚®ç®±ã€éªŒè¯ç è¯†åˆ« |
| é‚®ä»¶æ¨¡æ¿ç³»ç»Ÿ | âœ… 100% | å¯è§†åŒ–ç¼–è¾‘ã€å˜é‡æ’å…¥ã€æµ‹è¯•å‘é€ |
| è‡ªåŠ¨åŒ–è§„åˆ™ | âœ… 100% | è§„åˆ™å¼•æ“ã€æ¡ä»¶åŒ¹é…ã€åŠ¨ä½œæ‰§è¡Œ |
| è®¾ç½®é¡µé¢ | ğŸ”„ 80% | éƒ¨åˆ†åŠŸèƒ½å¾…å®Œå–„ |

### å¾…å®Œå–„åŠŸèƒ½

| åŠŸèƒ½ | ä¼˜å…ˆçº§ | è¯´æ˜ |
|------|--------|------|
| å¤šè´¦å·ç®¡ç† | ğŸ”´ é«˜ | é›†æˆå¤–éƒ¨ IMAP/SMTP è´¦å· |
| é‚®ä»¶åˆ«å | ğŸ”´ é«˜ | åˆ›å»ºå’Œç®¡ç†é‚®ä»¶åˆ«å |
| é»‘åå•ç®¡ç† | ğŸŸ¡ ä¸­ | å±è”½å‘ä»¶äººå®Œæ•´å®ç° |
| è‡ªåŠ¨æ¸…ç†ç­–ç•¥ | ğŸŸ¡ ä¸­ | åç«¯ API æŒä¹…åŒ– |
| è§’è‰²æƒé™ç³»ç»Ÿ | ğŸŸ¢ ä½ | é˜¶æ®µä¸‰è§„åˆ’ |

---

## ğŸ“œ ç‰ˆæƒå£°æ˜

```
Copyright Â© 2025 Talenting. All Rights Reserved.

æœ¬é¡¹ç›®ä¸ºç§æœ‰é¡¹ç›®ï¼Œä¿ç•™æ‰€æœ‰æƒåˆ©ã€‚
æœªç»æˆæƒï¼Œç¦æ­¢å¤åˆ¶ã€ä¿®æ”¹ã€åˆ†å‘æˆ–ä½¿ç”¨æœ¬é¡¹ç›®çš„ä»»ä½•éƒ¨åˆ†ã€‚

ä½œè€…: Zevan
```

---

<p align="center">
  <sub>Made with â¤ï¸ by Zevan @ Talenting</sub>
</p>
