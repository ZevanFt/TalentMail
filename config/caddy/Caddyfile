{
    # Enable local HTTPS for development
    local_certs
}

# This domain is now dynamically set by the WEB_DOMAIN environment variable
# which is generated by the scripts/generate_caddy_env.py script.
{$WEB_DOMAIN} {
    # Enable compression
    encode gzip zstd

    # Reverse proxy API requests to the backend service
    reverse_proxy /api/* backend:8000

    # Reverse proxy all other requests to the frontend service
    reverse_proxy /* frontend:3000
}
